@using AlDS.Coursework.Board.BoardModel;
@using AlDS.Coursework.Board.UserModel
@using Microsoft.AspNetCore.Identity
@using AlDS.Coursework.Board.RelatedTablesModel
@using AlDS.Coursework.WebApplicationTest.Data

@inject SignInManager<User> SignInManager
@inject UserManager<User> UserManager

@model AlDS.Coursework.Board.BoardModel.Board;

@{
    Layout = "../../Pages/Shared/_Layout.cshtml";
}



<div class="board_index">

    <div class="board">

        <div class="board_information">
            <p>@Model.Title</p>
        </div>

        <div class="board_setting"> 

            <table class="board_details">
                <tbody class ="board_details">
                @foreach(var elem in @Model.Cards)
                {
                    <tr class="table_details">
                        <td class="td_details">
                            <a class="a_board" href="../Card/Edit/@elem.CardId">
                                <p class="p_board">@elem.Title</p>
                            </a>
                        </td>
                        @foreach(var note in elem.Notes)
                        {
                            <td class="td_board_name">
                                <a class="a_board" href="../Note/Index/@note.NoteId">
                                    <p class="p_board">@note.Title</p>
                                </a>
                            </td>
                        }
                        <td class="td_board_name">
                              <form asp-action="Create" method="post">
                                 <input type="hidden" name="CreatorId" value = @User.Identity.Name>
                                 <input type="hidden" name="CardId" value = @elem.CardId>
                                 <input type="hidden" name="BoardId" value = @elem.BoardId>
                                <input class="placeholderCard" type="text" name="Title" placeholder="Введите название новой карты"/>
                                <input formaction="../../Note/Create" type="submit" value="Отправить" />
                              </form>                            
                        </td>
                    </tr>
                }
                </tbody>
            </table>
            <div class="board_details">
                <form method="post">
                   <input type="hidden" name="CreatorId" value = @User.Identity.Name>
                   <input type="hidden" name="BoardId" value = @Model.BoardId>
                  <label>Add new card:</label>
                  <input type="text" name="Title"/>

                  <input formaction="../../Card/Create" type="submit" value="Добавить" />
                </form>  
            </div>
        </div>

    </div>
</div>


   @section Scripts {
        @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    }

